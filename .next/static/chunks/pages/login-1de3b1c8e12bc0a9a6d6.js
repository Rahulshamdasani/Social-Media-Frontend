(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{1162:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return w}});var t=n(5861),o=n(4942),s=n(8152),a=n(7757),c=n.n(a),i=n(5005),l=n(6968),u=n(3942),p=n(1163),h=n(7294),d=n(4123),f=n(1958),g=n(2151),j=n(2167),m=n(5893);function v(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function x(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?v(Object(n),!0).forEach((function(r){(0,o.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function w(){var e=(0,u.I0)(),r=(0,p.useRouter)(),n=(0,d.OQ)(),a=(0,s.Z)(n,2),v=a[0],w=a[1],b=(w.isSuccess,w.isLoading),Z=w.isError,y=(w.data,w.error),O=(0,h.useState)({email:"",password:""}),k=O[0],E=O[1],P=k.email,_=k.password,C=(0,u.v9)((function(e){return e.auth.user}));(0,h.useEffect)((function(){null!==C&&r.push("/",void 0,{shallow:!0})}),[C]);var N=function(e){E(x(x({},k),{},(0,o.Z)({},e.target.name,e.target.value)))},T=function(){var r=(0,t.Z)(c().mark((function r(n){var t,o;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch("http://localhost:8000/auth/users/me/",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(n),Accept:"application/json"}});case 3:return t=r.sent,r.next=6,t.json();case 6:o=r.sent,console.log("".concat(o)),200===t.status&&e((0,f.av)({userdata:o})),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(0),console.log(r.t0);case 14:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}(),L=function(){var r=(0,t.Z)(c().mark((function r(){var n;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,v({email:P,password:_}).unwrap();case 3:n=r.sent,console.log("loginUser result?: ".concat(n)),e((0,f.o4)(n)),T(n.access),401===n.status&&console.alert("401, user not found. signup first"),Z&&(console.log("loginError: ".concat(y)),401===y.status&&console.alert("no user with that email address found, please sign up!")),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(0),console.log(r.t0);case 14:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(){return r.apply(this,arguments)}}(),G=function(){var e=(0,t.Z)(c().mark((function e(){var n,t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:8000/auth/o/google-oauth2/?redirect_uri=http://localhost:3000/google/",{method:"GET",headers:{Accept:"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:t=e.sent,r.replace(t.authorization_url,void 0,{shallow:!0}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{children:(0,m.jsx)("h3",{children:"Login Page"})}),(0,m.jsxs)(g.Z,{children:[(0,m.jsxs)(g.Z.Group,{className:"mb-3",controlId:"formBasicEmail",children:[(0,m.jsx)(g.Z.Label,{children:"Email Address"}),(0,m.jsx)(g.Z.Control,{type:"email",placeholder:"Enter Email",name:"email",onChange:N,value:P})]}),(0,m.jsxs)(g.Z.Group,{className:"mb-3",controlId:"formBasicPassword",children:[(0,m.jsx)(g.Z.Label,{children:"Password"}),(0,m.jsx)(g.Z.Control,{type:"password",placeholder:"Enter Password",name:"password",onChange:N,value:_})]}),(0,m.jsx)(g.Z.Text,{children:(0,m.jsx)(j.Z,{href:"/resetpassword",children:"Forgot Password?"})}),(0,m.jsx)(g.Z.Group,{className:"mb-3",controlId:"formBasicCheckbox",children:(0,m.jsx)(g.Z.Check,{type:"checkbox",label:"Check me out"})}),b?(0,m.jsxs)(i.Z,{variant:"primary",disabled:!0,children:[(0,m.jsx)(l.Z,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"}),"Loading..."]}):(0,m.jsx)(i.Z,{variant:"primary",onClick:L,children:"Login"}),(0,m.jsx)(i.Z,{variant:"warning",onClick:G,children:"Login With Google"}),(0,m.jsxs)(g.Z.Text,{children:["Don't have an account yet?",(0,m.jsx)(j.Z,{href:"/signup",children:"Sign up here"})]})]}),(0,m.jsx)("br",{})]})}},7156:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return n(1162)}])}},function(e){e.O(0,[436,774,888,179],(function(){return r=7156,e(e.s=r);var r}));var r=e.O();_N_E=r}]);