(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[684],{5553:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var o=n(5861),r=n(4942),c=n(8152),s=n(7757),a=n.n(s),l=n(6968),u=n(2151),i=n(5005),p=n(7294),f=n(1163),d=n(3942),h=n(1117),g=(n(1958),n(5893));function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(){var e,t=(0,f.useRouter)(),n=((0,d.I0)(),(0,d.v9)((function(e){return e.auth.user}))),s=(0,d.v9)((function(e){return e.auth.access})),x=(0,h.u3)(),v=(0,c.Z)(x,2),b=v[0],j=v[1],_=(j.loading,j.error),w=j.data,y=j.isLoading,O=j.isSuccess,E=j.isError,P=null!==(e=n.userdata.email)&&void 0!==e?e:null;(0,p.useEffect)((function(){void 0!==n&&null!==n&&(P=n.userdata.email)}),[n]),(0,p.useEffect)((function(){console.log("access_token: ".concat(s))}),[s]);var k=(0,p.useState)({post_text:""}),Z=k[0],C=k[1],N=Z.post_text;(0,p.useEffect)((function(){O&&t.push("/",void 0,{shallow:!0})}),[O]),(0,p.useEffect)((function(){n||(alert("You must be logged in to create a post!"),t.push("/login",void 0,{shallow:!0}))}),[n]),(0,p.useEffect)((function(){E&&console.log(_)}),[E]);var S=function(){var e=(0,o.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("post_author: ".concat(P)),console.log("post_text: ".concat(N)),console.log("accesss_token: ".concat(s)),e.next=6,b({post_author:P,post_text:N,access_token:s});case 6:"success"===w.status&&(console.log("Successfully created post!"),t.push("/profile/".concat(n.userdata.email),void 0,{shallow:!0})),E&&console.log("createPostError: ".concat(_)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("fallback error on createPost: ".concat(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h3",{children:"Create New Post"}),(0,g.jsx)("br",{}),y||void 0===n||null===n?(0,g.jsx)(l.Z,{animation:"border",role:"status",children:(0,g.jsx)("span",{className:"sr-only",children:"Loading..."})}):(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(u.Z.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:(0,g.jsx)(u.Z.Control,{type:"email",placeholder:"".concat(n.userdata.email),readOnly:!0,plaintext:!0})}),(0,g.jsx)(u.Z.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:(0,g.jsx)(u.Z.Control,{placeholder:"whats on your mind?",as:"textarea",rows:3,onChange:function(e){C(m(m({},Z),{},(0,r.Z)({},e.target.name,e.target.value)))},name:"post_text",value:N,type:"text",style:{resize:"none",height:"100px"}})}),(0,g.jsx)(i.Z,{variant:"primary",onClick:function(){return S()},children:"Post"})]})]})}},966:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/newpost",function(){return n(5553)}])}},function(e){e.O(0,[436,774,888,179],(function(){return t=966,e(e.s=t);var t}));var t=e.O();_N_E=t}]);